{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/javascript/embed-api/components/date-range-selector.js"],"names":["gapi","analytics","ready","nDaysAgo","dateFormat","convertDate","str","test","match","exec","daysAgo","firstDayOfMonth","Error","now","Date","year","getFullYear","toString","padStart","month","getMonth","numDays","date","setDate","getDate","String","length","day","createComponent","execute","options","get","container","document","getElementById","template","innerHTML","dateInputs","querySelectorAll","startDateInput","value","endDateInput","setValues","setMinMax","onchange","onChange","bind","emit","max","min"],"mappings":"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","file":"date-range-selector.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/javascript/embed-api/components/date-range-selector.js\");\n","// Copyright 2014 Google Inc. All rights reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n\n/* global gapi */\n\n\n/**\n * A DateRangeSelector component for the Embed API.\n */\ngapi.analytics.ready(function() {\n  const nDaysAgo = /(\\d+)daysAgo/;\n  const dateFormat = /\\d{4}-\\d{2}-\\d{2}/;\n\n  /**\n   * Convert a date acceptable to the Core Reporting API (e.g. `today`,\n   * `yesterday` or `NdaysAgo`) into the format YYYY-MM-DD. Dates\n   * already in that format are simply returned.\n   * @param {string} str The date string to format.\n   * @return {string} The formatted date.\n   */\n  function convertDate(str) {\n    // If str is in the proper format, do nothing.\n    if (dateFormat.test(str)) return str;\n\n    const match = nDaysAgo.exec(str);\n    if (match) {\n      return daysAgo(+match[1]);\n    } else if (str == 'today') {\n      return daysAgo(0);\n    } else if (str == 'yesterday') {\n      return daysAgo(1);\n    } else if (str == 'firstDayOfMonth') {\n      return firstDayOfMonth();\n    } else {\n      throw new Error('Cannot convert date ' + str);\n    }\n  }\n\n  /**\n   * Get a firstDayOfMonth formatted as YYYY-MM-DD\n   * @return {string} The formatted date.\n   */\n  function firstDayOfMonth() {\n    const now = new Date();\n    const year = now.getFullYear().toString().padStart(4, 0);\n    const month = (now.getMonth() + 1).toString().padStart(2, 0);\n\n    return `${year}-${month}-01`;\n  }\n\n  /**\n   * Accept a number and return a date formatted as YYYY-MM-DD that\n   * represents that many days ago.\n   * @param {number} numDays The number of days ago whose date to return.\n   * @return {string} The formatted date.\n   */\n  function daysAgo(numDays) {\n    const date = new Date();\n    date.setDate(date.getDate() - numDays);\n    let month = String(date.getMonth() + 1);\n    month = month.length == 1 ? '0' + month: month;\n    let day = String(date.getDate());\n    day = day.length == 1 ? '0' + day: day;\n    return date.getFullYear() + '-' + month + '-' + day;\n  }\n\n  gapi.analytics.createComponent('DateRangeSelector', {\n\n    /**\n     * Initialize the DateRangeSelector instance and render it to the page.\n     * @return {DateRangeSelector} The instance.\n     */\n    execute: function() {\n      const options = this.get();\n      options['start-date'] = options['start-date'] || '7daysAgo';\n      options['end-date'] = options['end-date'] || 'yesterday';\n\n      // Allow container to be a string ID or an HTMLElement.\n      this.container = typeof options.container == 'string' ?\n        document.getElementById(options.container) : options.container;\n\n      // Allow the template to be overridden.\n      if (options.template) this.template = options.template;\n\n      this.container.innerHTML = this.template;\n      const dateInputs = this.container.querySelectorAll('input');\n\n      this.startDateInput = dateInputs[0];\n      this.startDateInput.value = convertDate(options['start-date']);\n      this.endDateInput = dateInputs[1];\n      this.endDateInput.value = convertDate(options['end-date']);\n\n      this.setValues();\n      this.setMinMax();\n\n      this.container.onchange = this.onChange.bind(this);\n      return this;\n    },\n\n    /**\n     * Emit a change event based on the currently selected dates.\n     * Pass an object containing the start date and end date.\n     */\n    onChange: function() {\n      this.setValues();\n      this.setMinMax();\n      this.emit('change', {\n        'start-date': this['start-date'],\n        'end-date': this['end-date'],\n      });\n    },\n\n    /**\n     * Updates the instance properties based on the input values.\n     */\n    setValues: function() {\n      this['start-date'] = this.startDateInput.value;\n      this['end-date'] = this.endDateInput.value;\n    },\n\n    /**\n     * Updates the input min and max attributes so there's no overlap.\n     */\n    setMinMax: function() {\n      this.startDateInput.max = this.endDateInput.value;\n      this.endDateInput.min = this.startDateInput.value;\n    },\n\n    /**\n     * The html structure used to build the component. Developers can\n     * override this by passing it to the component constructor.\n     * The only requirement is that the structure contain two inputs, the\n     * first will be the start date and the second will be the end date.\n     */\n    template:\n      '<div class=\"DateRangeSelector\">' +\n      '  <div class=\"DateRangeSelector-item\">' +\n      '    <label>Start Date</label> ' +\n      '    <input type=\"date\">' +\n      '  </div>' +\n      '  <div class=\"DateRangeSelector-item\">' +\n      '    <label>End Date</label> ' +\n      '    <input type=\"date\">' +\n      '  </div>' +\n      '</div>',\n  });\n});\n"],"sourceRoot":""}